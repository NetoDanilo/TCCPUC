--NÚMERO DE ATAQUES POR ANO
SELECT D.IYEAR "ANO",COUNT(EVENT_ID) "NÚMERO DE ATAQUES" FROM PUCDW.EVENT E INNER JOIN PUCDW.DATE D
ON E.DATE_ID=D.DATE_ID
GROUP BY D.IYEAR
ORDER BY D.IYEAR
GO

--RESUMO POR PAÍS
SELECT R.COUNTRY_TXT AS "PAÍS",COUNT(E.EVENT_ID) AS "NÚMERO DE ATAQUES",SUM(E.SUCCESS) AS "COM SUCESSO", COUNT(E.EVENT_ID) - SUM(E.SUCCESS) AS FALHAS,
COUNT(DISTINCT R.CITY) AS CIDADES FROM PUCDW.EVENT E
INNER JOIN PUCDW.REGION R
ON E.REGION_ID=R.REGION_ID
GROUP BY R.COUNTRY_TXT
ORDER BY COUNT(E.EVENT_ID) DESC
GO

--QUATIDADE DE ATAQUES, ATAQUES COM SUCESSO E FALHAS
SELECT COUNT(EVENT_ID) AS "NÚMERO DE ATAQUES",SUM(SUCCESS) "COM SUCESSO",COUNT(EVENT_ID) - SUM(SUCCESS) AS FALHAS FROM PUCDW.EVENT
GO

--NÚMERO DE ATAQUES E MORTES POR REGIÃO
SELECT REGION_TXT AS "REGIÃO",COUNT(EVENT_ID) AS "NÚMERO DE ATAQUES",SUM(NKILL) AS "NÚMERO DE MORTES" FROM 
PUCDW.EVENT E INNER JOIN PUCDW.REGION R
ON E.REGION_ID=R.REGION_ID
GROUP BY REGION_TXT
GO

--NÚMERO DE MORTES POR ANO
SELECT D.IYEAR AS "ANO",SUM(NKILL) AS "NÚMERO DE MORTES" FROM 
PUCDW.EVENT E INNER JOIN PUCDW.DATE D
ON E.DATE_ID=D.DATE_ID
GROUP BY D.IYEAR
ORDER BY SUM(NKILL) DESC
GO

--PRINCIPAIS TIPOS DE ATAQUES
SELECT A.ATTACKTYPE1_TXT AS "TIPO DE ATAQUE",COUNT(EVENT_ID) AS "NÚMERO DE ATAQUES",SUM(NKILL) "NÚMERO DE MORTES" FROM PUCDW.EVENT E INNER JOIN PUCDW.ATTACK A
ON E.ATTACK_ID=A.ATTACK_ID
GROUP BY A.ATTACKTYPE1_TXT
ORDER BY COUNT(EVENT_ID) DESC
GO

--NÚMERO DE MORTES POR ATAQUES
SELECT A.ATTACKTYPE1_TXT AS "TIPO DE ATAQUE",SUM(NKILL) AS "NÚMERO DE MORTES" FROM PUCDW.EVENT E INNER JOIN PUCDW.ATTACK A
ON E.ATTACK_ID=A.ATTACK_ID
GROUP BY A.ATTACKTYPE1_TXT
ORDER BY SUM(NKILL) DESC
GO

--PRINCIPAIS ALVOS
SELECT T.TARGTYPE1_TXT AS "ALVO",COUNT(EVENT_ID) AS"NÚMERO DE ATAQUES" FROM PUCDW.EVENT E INNER JOIN PUCDW.TARGET T
ON E.TARGET_ID=T.TARGET_ID
GROUP BY T.TARGTYPE1_TXT
ORDER BY COUNT(EVENT_ID) DESC
GO

--ARMAS MAIS UTILIZADAS
SELECT W.WEAPTYPE1_TXT AS "ARMA",COUNT(EVENT_ID) AS "NÚMERO DE ATAQUES" FROM PUCDW.EVENT E INNER JOIN PUCDW.WEAPON W
ON E.WEAPON_ID=W.WEAPON_ID
GROUP BY W.WEAPTYPE1_TXT
ORDER BY COUNT(EVENT_ID) DESC
GO

--NÚMERO DE ATAQUES POR GRUPO E MORTES POR GRUPO
SELECT GNAME "GRUPO TERRORISTA",COUNT(EVENT_ID) "NÚMERO DE ATAQUES",SUM(NKILL) "NÚMERO DE MORTES" FROM EVENT F INNER JOIN GNAME G ON F.GNAME_ID = G.GNAME_ID
GROUP BY GNAME
ORDER BY COUNT(EVENT_ID) DESC
GO

--MORTES POR PAÍS
SELECT R.COUNTRY_TXT AS "PAÍS",SUM(NKILL) AS "NÚMERO DE MORTES" FROM PUCDW.EVENT E INNER JOIN PUCDW.REGION R
ON E.REGION_ID=R.REGION_ID
GROUP BY R.COUNTRY_TXT
ORDER BY SUM(NKILL) DESC
GO

--ATAQUES REIVINDICADOS POR GRUPO
SELECT G.GNAME AS "GRUPO TERRORISTA",SUM(CLAIMED) AS "NÚMERO DE MORTES" FROM PUCDW.EVENT E INNER JOIN PUCDW.GNAME G
ON E.GNAME_ID=G.GNAME_ID
WHERE CLAIMED <> -9
GROUP BY G.GNAME
ORDER BY SUM(CLAIMED) DESC
GO